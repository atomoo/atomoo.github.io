<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title>通过类创建对象，遍历对象的属性 · Atom</title><meta name="description" content="众所周知，通常在遍历JS中的对象的时候，一般会使用for...in或者Object.keys()方法，同时要注意属性的enumerable设置。  
在ES5中，我们定义一个类的写法如下：  
function Person(name) {
    this.name = name;
    Per"><meta name="keywords" content="Hexo,HTML,CSS,JavaScript"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><script type="text/javascript">var _hmt = _hmt || [];
(function() {
var hm = document.createElement("script");
hm.src = "https://hm.baidu.com/hm.js?93fb55cd04e96e77ad9d8b464314f2ef";
var s = document.getElementsByTagName("script")[0]; 
s.parentNode.insertBefore(hm, s);
})();</script><link rel="stylesheet" href="/css/prism-solarizedlight.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/asuka.jpg" style="width:127px;"><h3 title><a href="/">Atom</a></h3><div class="description"><p>Nothing is true<br>Everything is permitted</p></div></div></div><ul class="social-links"><li><a target="_blank" href="https://ask.fm/atompp"><i class="fa fa-question-circle"></i></a></li><li><a target="_blank" href="http://weibo.com/ypain"><i class="fa fa-weibo"></i></a></li><li><a target="_blank" href="http://github.com/atomoo"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>通过类创建对象，遍历对象的属性</a></h3></div><div class="post-content"><p>众所周知，通常在遍历JS中的对象的时候，一般会使用<code>for...in</code>或者<code>Object.keys()</code>方法，同时要注意属性的<code>enumerable</code>设置。  </p>
<p>在ES5中，我们定义一个类的写法如下：  </p>
<pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>say <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Shinji'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>使用<code>for...in</code>遍历对象<code>p</code>可以看到输出了<code>name</code>和<code>say</code>，因为<code>for...in</code>会遍历所有自己包括原型链上的可枚举属性，所以不仅输出了<code>name</code>，也输出了<code>say</code>。  </p>
<p>在ES6之后，定义一个类可以直接使用<code>class</code>:</p>
<pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Shinji'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>同样使用<code>for...in</code>遍历对象<code>p</code>，只得到了<code>name</code>。<br>使用<code>Object.getOwnPropertyDescriptors(Object.getPrototypeOf(p))</code>可以看到<code>constructor</code>和<code>say</code>的<code>enumerable</code>属性都是false，所以使用<code>for...in</code>遍历不出来。使用<code>Object.getOwnPropertyNames(Object.getPrototypeOf(p))</code>可以得到<code>[&quot;constructor&quot;, &quot;say&quot;]</code>，可以用来获取对象<code>p</code>拥有的方法，如果有继承，则需要再嵌套一层<code>getPrototypeOf</code>。  </p>
<p>在TypeScript中，定义一个类和es6差不多：</p>
<pre class="line-numbers language-ts"><code class="language-ts"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Shinji'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>但在使用<code>for...in</code>遍历的时候，发现和es5的输出差不多，其实是因为编译选项中将<code>target</code>设置为了<code>ES5</code>，编译后的代码和上面es5的代码差不多，所以<code>say</code>的<code>enumerable</code>为true，如果设置<code>target</code>为<code>ESNEXT</code>，则就和es6的表现差不多了。<br>总之，TypeScript和ES6的<code>class</code>并不一样，毕竟TypeScript还是需要编译成JavaScript的。但是如果是使用babel将ES6的<code>class</code>编译到es5，<code>say()</code>的<code>enumerable</code>会设置为<code>false</code>。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2019-03-11</span><i class="fa fa-tag"></i><a class="tag" href="/tags/TypeScript/" title="TypeScript">TypeScript </a></div></div></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2019/06/18/hello-RxJS/" title="hello RxJS">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/10/01/hello-world/" title="Hello World">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>